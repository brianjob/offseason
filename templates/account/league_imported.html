{% extends "base.html" %}
{% block content %}
<div class="container">
<table class="table">
	<thead>
		<tr><th>Team</th><th>Imported</th></tr>
	</thead>
	<tbody>
		{% for team in league.team_set.all %}
		<tr class="team-row" data-id="{{team.id}}">
			<td>{{team.name}}</td>
			<td class="result"><i class="glyphicon glyphicon-unchecked"></i></td>
		</tr>
		{% endfor %}
	</tbody>
</table>
</div>
<script type="text/javascript">
$(function() {
	$(".team-row").each(function() {
		var id = $(this).data('id');
		var result = $(this).children('.result');

		$.post("{% url 'account:fill_roster' %}",
		{
			team_id : id,
			access_token : "{{access_token}}",

		}).done(function(data) {
			data = JSON.parse(data);
			if (data.result == 'success') {
				result.children('i').removeClass('glyphicon-unchecked')
				.addClass('glyphicon-ok');
			} else {
				result.children('i').removeClass('glyphicon-unchecked')
				.addClass('glyphicon-remove');
			}
		});
	});
})
</script>
{% endblock %}
